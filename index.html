<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SteemGram</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="assets/css/main.css">
    <script>
        // Handle 404 redirects on GitHub Pages
        (function() {
            function getRepositoryName() {
                // Check if we're on GitHub Pages
                const ghRegex = /https?:\/\/([^.]+)\.github\.io\/([^\/]+)/;
                const match = window.location.href.match(ghRegex);
                return match && match[2] ? '/' + match[2] : '';
            }
            
            const repoPath = getRepositoryName();
            const pathname = location.pathname;
            
            // Remove repository name from pathname if present
            let cleanPath = pathname;
            if (repoPath && pathname.startsWith(repoPath)) {
                cleanPath = pathname.substring(repoPath.length) || '/';
            }
            
            // If we're on a path other than root and it's a direct page load
            if (cleanPath !== '/' && 
                cleanPath !== '/index.html' && 
                !location.hash) {
                
                // Store the path we tried to access
                sessionStorage.setItem('redirectPath', cleanPath);
                
                // Redirect to the root with a hash path
                if (repoPath) {
                    // For GitHub Pages with repository name
                    location.replace(repoPath + '/#' + cleanPath);
                } else {
                    // For root domain
                    location.replace('/#' + cleanPath);
                }
            }
            
            // Check if we need to restore a redirect path
            window.addEventListener('DOMContentLoaded', function() {
                var redirectPath = sessionStorage.getItem('redirectPath');
                if (redirectPath && !location.hash) {
                    history.replaceState(null, null, '/#' + redirectPath);
                    sessionStorage.removeItem('redirectPath');
                }
            });
        })();
    </script>
</head>
<body>
    <div id="app">
        <!-- App will be rendered here by JavaScript -->
        <nav class="main-nav">
            <div class="nav-container">
                <div class="nav-left">
                    <a href="/" class="logo">
                        <img src="./assets/img/logo_tra.png" alt="SteemGram" class="logo-img">
                        <span class="logo-text">SteemGram</span>
                    </a>
                </div>
                <div class="nav-center">
                    <div class="nav-search">
                        <span class="material-icons search-icon">search</span>
                        <input type="text" placeholder="Search SteemGram">
                    </div>
                </div>
                <div class="nav-right">
                    <!-- Will be populated by JS -->
                </div>
            </div>
        </nav>
        
        <aside class="side-nav">
            <div class="menu-items">
                <a href="/" class="menu-item active">
                    <span class="material-icons icon">home</span>
                    <span class="label">Home</span>
                </a>
                <a href="/trending" class="menu-item">
                    <span class="material-icons icon">trending_up</span>
                    <span class="label">Trending</span>
                </a>
                <a href="/hot" class="menu-item">
                    <span class="material-icons icon">whatshot</span>
                    <span class="label">Hot</span>
                </a>
                <a href="/new" class="menu-item">
                    <span class="material-icons icon">new_releases</span>
                    <span class="label">New</span>
                </a>
                <a href="/promoted" class="menu-item">
                    <span class="material-icons icon">rocket_launch</span>
                    <span class="label">Promoted</span>
                </a>
                <a href="/wallet" class="menu-item">
                    <span class="material-icons icon">account_balance_wallet</span>
                    <span class="label">Wallet</span>
                </a>
            </div>
        </aside>
        
        <main id="main-content">
            <!-- Content will be inserted here by the router -->
        </main>
        <nav id="bottom-navigation" class="bottom-navigation">
            <!-- Will be populated by JS -->
        </nav>
    </div>

    <!-- Add Markdown parser and HTML sanitizer -->
    <script src="https://cdn.jsdelivr.net/npm/marked@5.1.2/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
    
    <script type="module" src="index.js"></script>
</body>
</html>
